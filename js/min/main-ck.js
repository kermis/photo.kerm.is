function init(){renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.domElement.setAttribute("class","three-js-renderer"),document.body.appendChild(renderer.domElement),camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,2010),camera.position.y=5,camera.rotation.y=4,scene=new THREE.Scene,light=new THREE.HemisphereLight(16777200,1052704,1),light.position.set(.75,1,.25),scene.add(light);var e=new THREE.SphereGeometry(2e3,60,40),t=new THREE.MeshBasicMaterial({color:14215167,doubleSided:!0}),o=new THREE.Mesh(e,t);o.scale.set(-1,1,1),scene.add(o),scene.add(camera);var n=document.getElementById("inputCanvas");texture=new THREE.Texture(n),texture.needsUpdate=!0,material=new THREE.MeshBasicMaterial({map:texture,name:"webcam"}),material.needsUpdate=!0,camera.position.y=5,camera.rotation.y=4;var i=new THREE.ObjectLoader;i.load("js/Unicorn_with_castle.js",function(e){e.position.set(30,-4.05,30),e.scale.set(3,3,3),e.rotation.y=1.4,unicorn=e,scene.add(unicorn)}),cube=new THREE.Mesh(new THREE.SphereGeometry(1.5,10,10),material),cube.position.y=12.3,cube.position.z=31.7,cube.position.x=30,cube.rotation.y=2.4,scene.add(cube);var a=new THREE.ObjectLoader;a.load("js/stage.js",function(e){stage=e,stage.rotation.y=-.25;var t=new THREE.Mesh(new THREE.BoxGeometry(0,10,15),material),o=t.clone();t.position.set(0,9,-9),o.scale.set(.5,.5,.5),o.position.set(0,14,10);var n=o.clone();n.position.set(0,14,-30),stage.add(t),stage.add(o),stage.add(n),stage.position.set(-55,0,-3.5),scene.add(stage);for(var i=0;i<stage.children[0].children.length;i++){scene.updateMatrixWorld();var a=new THREE.Mesh(new THREE.SphereGeometry(.4,10,10),material),r=new THREE.Vector3;r.setFromMatrixPosition(stage.children[0].children[i].matrixWorld),a.position.set(r.x,r.y,r.z),scene.add(a)}}),a.load("js/photoscape.js",function(e){clouds=e.children[2];var t=1;e.scale.set(t,t,t),e.position.y=-5,e.rotation.y=2.64,scene.add(e)}),a.load("js/booth.js",function(e){var t=.03;e.scale.set(t,t,t),e.position.set(0,0,-20),scene.add(e);var o=e.children[0].children[0];scene.updateMatrixWorld();var n=new THREE.Mesh(new THREE.BoxGeometry(3,2.8,4),material),i=new THREE.Vector3;i.setFromMatrixPosition(o.matrixWorld),n.position.set(i.x+1,i.y,i.z),scene.add(n),gordijn=new THREE.Mesh(new THREE.BoxGeometry(20,20,.2),new THREE.MeshLambertMaterial({color:10551310,doubleSided:!0,transparent:!0,opacity:1})),gordijn.position.z=-17.25,scene.add(gordijn),photoBoothActive=!0}),a.load("js/kerm.is.js",function(e){var t=e.clone(),o=.25;e.scale.set(o,o,o);for(var n=0;n<e.children.length;n++)e.children[n].children[0].material=new THREE.MeshLambertMaterial({color:getRandomColor()});e.rotation.y=1.57,e.position.set(1.2,2.7,-19.8),scene.add(e),wall=new THREE.Mesh(new THREE.BoxGeometry(1,12,10),new THREE.MeshLambertMaterial({color:"#FFFFFF"})),wall.rotation.y=1.57,wall.position.set(6.2,5.5,-22.82),ls=wall,scene.add(wall);var o=1.5;t.scale.set(o,o,o),t.rotation.y=-1.77,t.position.set(72,4,29),scene.add(t);var i=t.clone();i.rotation.y=-1.22,i.position.set(56,4,115),scene.add(i)}),camera.rotation.y=7.85,camera.position.set(13,4.7,-19.8);var r=window.innerWidth,s=window.innerHeight}function animate(){requestAnimationFrame(animate),renderer.render(scene,camera),clouds&&(clouds.rotation.y+=.001),gordijn&&(photoBoothActive&&gordijn.material.opacity<=1?gordijn.material.opacity+=.02:gordijn.material.opacity>=0&&(gordijn.material.opacity-=.05),gordijn.material.opacity>1&&(gordijn.material.opacity=1)),wall&&(colorLoopTick+=.001,wall.material.color.setHSL(colorLoopTick,1,.8)),texture.needsUpdate=!0,TWEEN.update()}function nextScene(){switch(currentScene){case"booth":switchScene("unicorn");break;case"unicorn":switchScene("stage");break;case"stage":switchScene("booth")}}function previousScene(){switch(currentScene){case"booth":switchScene("stage");break;case"unicorn":switchScene("booth");break;case"stage":switchScene("unicorn")}}function switchScene(e){switch(photoBoothActive=!1,currentScene=e,e){case"stage":moveCam(camPositions[1].position.x,camPositions[1].position.y,camPositions[1].position.z,camPositions[1].rotation.x,camPositions[1].rotation.y,camPositions[1].rotation.z,1);break;case"unicorn":moveCam(camPositions[0].position.x,camPositions[0].position.y,camPositions[0].position.z,camPositions[0].rotation.x,camPositions[0].rotation.y,camPositions[0].rotation.z,1);break;case"booth":photoBoothActive=!0,moveCam(camPositions[2].position.x,camPositions[2].position.y,camPositions[2].position.z,camPositions[2].rotation.x,camPositions[2].rotation.y,camPositions[2].rotation.z,1)}}function moveCam(e,t,o,n,i,a,r){new TWEEN.Tween(camera.position).to({x:e,y:t,z:o},r).easing(TWEEN.Easing.Sinusoidal.InOut).start(),new TWEEN.Tween(camera.rotation).to({x:n,y:i,z:a},r).easing(TWEEN.Easing.Sinusoidal.InOut).start()}function getRandomColor(){for(var e="0123456789ABCDEF".split(""),t="#",o=0;6>o;o++)t+=e[Math.floor(16*Math.random())];return t}function takeAPicture(){window.open(renderer.domElement.toDataURL("image/png"),"screenshot_"+Date.now())}var scene,camera,renderer,material,texture,unicorn,stage,clouds,gordijn,wall,photoBoothActive=!1,currentScene="booth",colorLoopTick=0;init(),animate();var camPositions=[{"for":"unicorn",rotation:{x:0,y:4,z:0},position:{x:0,y:5,z:0}},{"for":"stage",rotation:{x:0,y:1.32,z:0},position:{x:0,y:8.5,z:0}},{"for":"booth",rotation:{x:0,y:1.57,z:0},position:{x:13,y:4.7,z:-19.8}}],ls;window.addEventListener("resize",function(){renderer&&camera&&(camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight))},!0),$("arrow-l").on("click",function(){previousScene()}),$(".picture-button").on("click",function(){takeAPicture()}),$("arrow-r").on("click",function(){nextScene()}),$(".aperture-part").css({width:window.innerWidth,height:window.innerWidth}),$(".apert");for(var fxBtns=document.getElementsByClassName("btn-effect"),i=0;i<fxBtns.length;i++)fxBtns[i].addEventListener("click",function(){var e=this.innerHTML.toLowerCase();switchEffect(e)},!1);