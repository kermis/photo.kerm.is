function FilterUtils(){this.HSVtoRGB=function(t,a,e){var i,r,n,s=Math.floor(6*t),l=6*t-s,h=e*(1-a),o=e*(1-l*a),u=e*(1-(1-l)*a);switch(s%6){case 0:i=e,r=u,n=h;break;case 1:i=o,r=e,n=h;break;case 2:i=h,r=e,n=u;break;case 3:i=h,r=o,n=e;break;case 4:i=u,r=h,n=e;break;case 5:i=e,r=h,n=o}return[255*i,255*r,255*n]},this.RGBtoHSV=function(t,a,e){t/=255,a/=255,e/=255;var i=Math.max(t,a,e),r=Math.min(t,a,e),n,s,l=i,h=i-r;if(s=0===i?0:h/i,i===r)n=0;else{switch(i){case t:n=(a-e)/h+(e>a?6:0);break;case a:n=(e-t)/h+2;break;case e:n=(t-a)/h+4}n/=6}return[n,s,l]},this.getPixel=function(t,a,e,i,r){var n=4*(e*i+a);return 0>a||a>=i||0>e||e>=r?[t[4*(this.clampPixel(e,0,r-1)*i+this.clampPixel(a,0,i-1))],t[4*(this.clampPixel(e,0,r-1)*i+this.clampPixel(a,0,i-1))+1],t[4*(this.clampPixel(e,0,r-1)*i+this.clampPixel(a,0,i-1))+2],t[4*(this.clampPixel(e,0,r-1)*i+this.clampPixel(a,0,i-1))+3]]:[t[n],t[n+1],t[n+2],t[n+3]]};var t=!1,a;this.gaussianRandom=function(){if(t)return t=!1,a;var e,i,r;do e=2*Math.random()-1,i=2*Math.random()-1,r=e*e+i*i;while(r>=1||0===r);var n=Math.sqrt(-2*Math.log(r)/r);return a=i*n,t=!0,e*n},this.clampPixel=function(t,a,e){return a>t?a:t>e?e:t},this.triangle=function(t){var a=this.mod(t,1);return 2*(.5>a?a:1-a)},this.mod=function(t,a){var e=parseInt(t/a,10);return t-=e*a,0>t?t+a:t},this.mixColors=function(t,a,e){var i=this.linearInterpolate(t,a[0],e[0]),r=this.linearInterpolate(t,a[1],e[1]),n=this.linearInterpolate(t,a[2],e[2]),s=this.linearInterpolate(t,a[3],e[3]);return[i,r,n,s]},this.linearInterpolate=function(t,a,e){return a+t*(e-a)},this.bilinearInterpolate=function(t,a,e,i,r,n){var s,l,h=e[0],o=e[1],u=e[2],d=e[3],v=i[0],f=i[1],m=i[2],c=i[3],g=r[0],p=r[1],x=r[2],V=r[3],w=n[0],F=n[1],M=n[2],b=n[3],I=1-t,A=1-a;s=I*d+t*c,l=I*V+t*b;var y=A*s+a*l;s=I*h+t*v,l=I*g+t*w;var R=A*s+a*l;s=I*o+t*f,l=I*p+t*F;var D=A*s+a*l;s=I*u+t*m,l=I*x+t*M;var S=A*s+a*l;return[R,D,S,y]},this.tableFilter=function(t,a,e,i){for(var r=0;i>r;r++)for(var n=0;e>n;n++)for(var s=4*(r*e+n),l=0;3>l;l++)t[s+l]=a[t[s+l]]},this.convolveFilter=function(t,a,e,i){var r=[],n,s;n=s=Math.sqrt(a.length);for(var l=parseInt(n/2,10),h=parseInt(s/2,10),o=!0,u=0;i>u;u++)for(var d=0;e>d;d++){for(var v=4*(u*e+d),f=0,m=0,c=0,g=-l;l>=g;g++){var p=u+g,x;x=p>=0&&i>p?p*e:u*e;for(var V=s*(g+l)+h,w=-h;h>=w;w++){var F=a[V+w];if(0!==F){var M=d+w;M>=0&&e>M||(M=d);var b=4*(x+M);f+=F*t[b],m+=F*t[b+1],c+=F*t[b+2]}}}r[v]=parseInt(f+.5,10),r[v+1]=parseInt(m+.5,10),r[v+2]=parseInt(c+.5,10),r[v+3]=t[v+3]}for(var I=0;I<r.length;I++)t[I]=r[I]},this.transformFilter=function(t,a,e,i){for(var r=[],n=[],s=0;s<t.length;s++)n[s]=t[s];for(var l=0;i>l;l++)for(var h=0;e>h;h++){var o=4*(l*e+h);a.apply(this,[h,l,r]);var u=Math.floor(r[0]),d=Math.floor(r[1]),v=r[0]-u,f=r[1]-d,m,c,g,p;if(u>=0&&e-1>u&&d>=0&&i-1>d){var x=4*(e*d+u);m=[t[x],t[x+1],t[x+2],t[x+3]],c=[t[x+4],t[x+5],t[x+6],t[x+7]],g=[t[x+4*e],t[x+4*e+1],t[x+4*e+2],t[x+4*e+3]],p=[t[x+4*(e+1)],t[x+4*(e+1)+1],t[x+4*(e+1)+2],t[x+4*(e+1)+3]]}else m=this.getPixel(t,u,d,e,i),c=this.getPixel(t,u+1,d,e,i),g=this.getPixel(t,u,d+1,e,i),p=this.getPixel(t,u+1,d+1,e,i);var V=this.bilinearInterpolate(v,f,m,c,g,p);n[o]=V[0],n[o+1]=V[1],n[o+2]=V[2],n[o+3]=V[3]}for(var w=0;w<n.length;w++)t[w]=n[w]}}function BlurFilter(){this.name="Blur",this.isDirAnimatable=!1,this.defaultValues={amount:5},this.valueRanges={amount:{min:0,max:10}},this.filter=function(t,a){var e=t.width,i=e<<2,r=t.height,n=t.data,s,l=a.amount;0>l&&(l=0),s=l>=2.5?.98711*l-.9633:l>=.5?3.97156-4.14554*Math.sqrt(1-.26891*l):2*l*(3.97156-4.14554*Math.sqrt(.865545));var h=s*s,o=h*s,u=1.57825+2.44413*s+1.4281*h+.422205*o,d=(2.44413*s+2.85619*h+1.26661*o)/u,v=-(1.4281*h+1.26661*o)/u,f=.422205*o/u,m=1-(d+v+f),c=0,g,p,x,V,w,F;for(c=0;3>c;c++)for(var M=0;r>M;M++){for(g=M*i+c,p=M*i+(e-1<<2)+c,x=n[g],V=x,w=V,F=w;p>=g;g+=4)x=m*n[g]+d*V+v*w+f*F,n[g]=x,F=w,w=V,V=x;for(g=M*i+(e-1<<2)+c,p=M*i+c,x=n[g],V=x,w=V,F=w;g>=p;g-=4)x=m*n[g]+d*V+v*w+f*F,n[g]=x,F=w,w=V,V=x}for(c=0;3>c;c++)for(var b=0;e>b;b++){for(g=(b<<2)+c,p=(r-1)*i+(b<<2)+c,x=n[g],V=x,w=V,F=w;p>=g;g+=i)x=m*n[g]+d*V+v*w+f*F,n[g]=x,F=w,w=V,V=x;for(g=(r-1)*i+(b<<2)+c,p=(b<<2)+c,x=n[g],V=x,w=V,F=w;g>=p;g-=i)x=m*n[g]+d*V+v*w+f*F,n[g]=x,F=w,w=V,V=x}}}function BrightnessFilter(){this.name="Brightness",this.isDirAnimatable=!0,this.defaultValues={amount:0},this.valueRanges={amount:{min:-1,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);for(var s=void 0===e.amount?this.defaultValues.amount:e.amount,l=0;r>l;l++)for(var h=0;i>h;h++){var o=4*(l*i+h),u=t.RGBtoHSV(n[o],n[o+1],n[o+2]);u[2]+=s,u[2]<0?u[2]=0:u[2]>1&&(u[2]=1);for(var d=t.HSVtoRGB(u[0],u[1],u[2]),v=0;3>v;v++)n[o+v]=d[v]}}}function BumpFilter(){this.name="Bump",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data,s=[-1,-1,0,-1,1,1,0,1,1];t.convolveFilter(n,s,i,r)}}function CircleSmearFilter(){this.name="Circle Smear",this.isDirAnimatable=!1,this.defaultValues={size:4,density:.5,mix:.5},this.valueRanges={size:{min:1,max:10},density:{min:0,max:1},mix:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){for(var i=a.width,r=a.height,n=a.data,s=[],l=0;l<n.length;l++)s[l]=n[l];void 0===e&&(e=this.defaultValues);var h=void 0===e.size?this.defaultValues.size:e.size;1>h&&(h=1),h=parseInt(h,10);for(var o=void 0===e.density?this.defaultValues.density:e.density,u=void 0===e.mix?this.defaultValues.mix:e.mix,d=h+1,v=d*d,f=parseInt(2*o/30*i*r/2,10),m=0;f>m;m++)for(var c=(Math.random()*Math.pow(2,32)&2147483647)%i,g=(Math.random()*Math.pow(2,32)&2147483647)%r,p=[n[4*(g*i+c)],n[4*(g*i+c)+1],n[4*(g*i+c)+2],n[4*(g*i+c)+3]],x=c-d;c+d+1>x;x++)for(var V=g-d;g+d+1>V;V++){var w=(x-c)*(x-c)+(V-g)*(V-g);if(x>=0&&i>x&&V>=0&&r>V&&v>=w)for(var F=[s[4*(V*i+x)],s[4*(V*i+x)+1],s[4*(V*i+x)+2],s[4*(V*i+x)+3]],M=t.mixColors(u,F,p),b=0;3>b;b++)s[4*(V*i+x)+b]=M[b]}for(var I=0;I<s.length;I++)n[I]=s[I]}}function ContrastFilter(){if(this.name="Contrast",this.isDirAnimatable=!0,this.defaultValues={amount:1},this.valueRanges={amount:{min:0,max:2}},!FilterUtils)return void(console&&console.error("Unable to find filterutils.js, please include this file! (Required by "+this.name+" filter)"));var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.amount?this.defaultValues.amount:e.amount;0>s&&(s=0);for(var l=[],h=0;256>h;h++)l[h]=parseInt(255*((h/255-.5)*s+.5),10);t.tableFilter(n,l,i,r)}}function CrossSmearFilter(){this.name="Cross Smear",this.isDirAnimatable=!1,this.defaultValues={distance:8,density:.5,mix:.5},this.valueRanges={distance:{min:0,max:30},density:{min:0,max:1},mix:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){for(var i=a.width,r=a.height,n=a.data,s=[],l=0;l<n.length;l++)s[l]=n[l];void 0===e&&(e=this.defaultValues);var h=void 0===e.distance?this.defaultValues.distance:e.distance;0>h&&(h=0),h=parseInt(h,10);for(var o=void 0===e.density?this.defaultValues.density:e.density,u=void 0===e.mix?this.defaultValues.mix:e.mix,d=parseInt(2*o*i*r/(h+1),10),v=0;d>v;v++){for(var f=(Math.random()*Math.pow(2,32)&2147483647)%i,m=(Math.random()*Math.pow(2,32)&2147483647)%r,c=Math.random()*Math.pow(2,32)%h+1,g=[n[4*(m*i+f)],n[4*(m*i+f)+1],n[4*(m*i+f)+2],n[4*(m*i+f)+3]],p,x,V,w=f-c;f+c+1>w;w++)if(w>=0&&i>w)for(p=[s[4*(m*i+w)],s[4*(m*i+w)+1],s[4*(m*i+w)+2],s[4*(m*i+w)+3]],x=t.mixColors(u,p,g),V=0;3>V;V++)s[4*(m*i+w)+V]=x[V];for(var F=m-c;m+c+1>F;F++)if(F>=0&&r>F)for(p=[s[4*(F*i+f)],s[4*(F*i+f)+1],s[4*(F*i+f)+2],s[4*(F*i+f)+3]],x=t.mixColors(u,p,g),V=0;3>V;V++)s[4*(F*i+f)+V]=x[V]}for(var M=0;M<s.length;M++)n[M]=s[M]}}function DiffusionFilter(){this.name="Diffusion",this.isDirAnimatable=!1,this.defaultValues={scale:4},this.valueRanges={scale:{min:1,max:100}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);for(var s=void 0===e.scale?this.defaultValues.scale:e.scale,l=[],h=[],o=[],u=[],d=0;256>d;d++){var v=2*Math.PI*d/256;o[d]=s*Math.sin(v),u[d]=s*Math.cos(v)}transInverse=function(t,a,e){var i=parseInt(255*Math.random(),10),r=Math.random();e[0]=t+r*o[i],e[1]=a+r*u[i]},t.transformFilter(n,transInverse,i,r)}}function DitherFilter(){this.name="Dither",this.isDirAnimatable=!1,this.defaultValues={levels:3,color:!0},this.valueRanges={levels:{min:2,max:30},color:{min:!1,max:!0}};var t=new FilterUtils;this.filter=function(t,a){var e=t.width,i=t.height,r=t.data,n=[],s,l;for(l=0;l<r.length;l++)n[l]=0;void 0===a&&(a=this.defaultValues);var h=void 0===a.levels?this.defaultValues.levels:a.levels,o=void 0===a.color?this.defaultValues.color:a.color;1>=h&&(h=1);var u=[0,0,0,0,0,7,3,5,1],d=16,v=0,f=[];for(s=0;h>s;s++)f[s]=parseInt(255*s/(h-1),10);var m=[];for(s=0;256>s;s++)m[s]=parseInt(h*s/256,10);for(var c=0;i>c;c++){var g=1==(1&c),p;g?(v=4*(c*e+e-1),p=-1):(v=c*e*4,p=1);for(var x=0;e>x;x++){var V=r[v],w=r[v+1],F=r[v+2];o||(V=w=F=parseInt((V+w+F)/3,10));var M=f[m[V]],b=f[m[w]],I=f[m[F]];n[v]=M,n[v+1]=b,n[v+2]=I,n[v+3]=r[v+3];var A=V-M,y=w-b,R=F-I;for(s=-1;1>=s;s++){var D=s+c;if(D>=0&&i>D)for(l=-1;1>=l;l++){var S=l+x;if(S>=0&&e>S){var P;if(P=g?u[3*(s+1)-l+1]:u[3*(s+1)+l+1],0!==P){var W=g?v-4*l:v+4*l;V=r[W],w=r[W+1],F=r[W+2];var U=P/d;V+=A*U,w+=y*U,F+=R*U,r[W]=V,r[W+1]=w,r[W+2]=F}}}}v+=4*p}}for(l=0;l<n.length;l++)r[l]=n[l]}}function EdgeFilter(){this.name="Edge Detection",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={};var t=[-1,-2,-1,0,0,0,1,2,1],a=[-1,0,1,-2,0,2,-1,0,1];this.filter=function(e,i){for(var r=e.width,n=e.height,s=e.data,l=[],h=0;n>h;h++)for(var o=0;r>o;o++){var u=4*(h*r+o),d=0;gh=0,bh=0;var v=0;gv=0,bv=0;for(var f=-1;1>=f;f++){var m=h+f,c;c=m>=0&&n>m?m*r*4:h*r*4;for(var g=3*(f+1)+1,p=-1;1>=p;p++){var x=o+p;x>=0&&r>x||(x=o),x*=4;var V=s[c+x],w=s[c+x+1],F=s[c+x+2],M=t[g+p],b=a[g+p];d+=parseInt(M*V,10),bh+=parseInt(M*w,10),gh+=parseInt(M*F,10),v+=parseInt(b*V,10),gv+=parseInt(b*w,10),bv+=parseInt(b*F,10)}}V=parseInt(Math.sqrt(d*d+v*v)/1.8,10),w=parseInt(Math.sqrt(gh*gh+gv*gv)/1.8,10),F=parseInt(Math.sqrt(bh*bh+bv*bv)/1.8,10),l[u]=V,l[u+1]=w,l[u+2]=F,l[u+3]=s[u+3]}for(var I=0;I<l.length;I++)s[I]=l[I]}}function EmbossFilter(){this.name="Emboss",this.isDirAnimatable=!1,this.defaultValues={height:1,angle:135,elevation:30},this.valueRanges={height:{min:1,max:10},angle:{min:0,max:360},elevation:{min:0,max:180}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);var n=void 0===a.height?this.defaultValues.height:a.height,s=void 0===a.angle?this.defaultValues.angle:a.angle,l=void 0===a.elevation?this.defaultValues.elevation:a.elevation;s=s/180*Math.PI,l=l/180*Math.PI;for(var h=3*n,o=255.9,u=[],d=e,v=i,f=0;f<r.length;f+=4)u[f/4]=(r[f]+r[f+1]+r[f+2])/3;var m,c,g,p,x,V,w,F,M,b,I;p=parseInt(Math.cos(s)*Math.cos(l)*o,10),x=parseInt(Math.sin(s)*Math.cos(l)*o,10),V=parseInt(Math.sin(l)*o,10),g=parseInt(1530/h,10),w=g*g,F=g*V,I=V;for(var A=0,y=0;i>y;y++,A+=d)for(var R=A,D=R+d,S=D+d,P=0;e>P;P++,R++,D++,S++){var W=4*(y*e+P);0!==y&&i-2>y&&0!==P&&e-2>P?(m=u[R-1]+u[D-1]+u[S-1]-u[R+1]-u[D+1]-u[S+1],c=u[S-1]+u[S]+u[S+1]-u[R-1]-u[R]-u[R+1],b=0===m&&0===c?I:(M=m*p+c*x+F)<0?0:parseInt(M/Math.sqrt(m*m+c*c+w),10)):b=I,r[W]=r[W+1]=r[W+2]=b}}}function ExposureFilter(){this.name="Exposure",this.isDirAnimatable=!0,this.defaultValues={exposure:1},this.valueRanges={exposure:{min:0,max:5}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);for(var s=void 0===e.exposure?this.defaultValues.exposure:e.exposure,l=[],h=0;256>h;h++)l[h]=parseInt(255*(1-Math.exp(-(h/255)*s)),10);t.tableFilter(n,l,i,r)}}function GainFilter(){this.name="Gain/Bias",this.isDirAnimatable=!0,this.defaultValues={gain:.5,bias:.5},this.valueRanges={gain:{min:0,max:1},bias:{min:0,max:1}};var t=[],a=new FilterUtils;this.filter=function(t,e){var i=t.width,r=t.height,n=t.data;void 0===e&&(e=this.defaultValues);for(var s=void 0===e.gain?this.defaultValues.gain:e.gain,l=void 0===e.bias?this.defaultValues.bias:e.bias,h=[],o=0;256>o;o++){var u=o/255,d=(1/s-2)*(1-2*u);u=.5>u?u/(d+1):(d-u)/(d-1),u/=(1/l-2)*(1-u)+1,h[o]=parseInt(255*u,10)}a.tableFilter(n,h,i,r)}}function GammaFilter(){this.name="Gamma",this.isDirAnimatable=!0,this.defaultValues={amount:1},this.valueRanges={amount:{min:0,max:2}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);var n=void 0===a.amount?this.defaultValues.amount:a.amount;if(0>n&&(n=0),!FilterUtils)return void(console&&console.error("Unable to find filterutils.js, please include this file! (Required by "+this.name+" filter)"));for(var s=new FilterUtils,l=[],h=0;256>h;h++)l[h]=255*Math.pow(h/255,1/n)+.5;s.tableFilter(r,l,e,i)}}function GrayscaleFilter(){this.name="Grayscale",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={},this.filter=function(t,a){for(var e=t.width,i=t.height,r=t.data,n=0;i>n;n++)for(var s=0;e>s;s++){var l=4*(n*e+s),h=.3*r[l]+.59*r[l+1]+.11*r[l+2];r[l]=r[l+1]=r[l+2]=h}}}function HueFilter(){this.name="Hue",this.isDirAnimatable=!0,this.defaultValues={amount:0},this.valueRanges={amount:{min:-1,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);for(var s=void 0===e.amount?this.defaultValues.amount:e.amount,l=0;r>l;l++)for(var h=0;i>h;h++){var o=4*(l*i+h),u=t.RGBtoHSV(n[o],n[o+1],n[o+2]);for(u[0]+=s;u[0]<0;)u[0]+=360;for(var d=t.HSVtoRGB(u[0],u[1],u[2]),v=0;3>v;v++)n[o+v]=d[v]}}}function InvertFilter(){this.name="Invert",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={},this.filter=function(t,a){for(var e=t.width,i=t.height,r=t.data,n=0;i>n;n++)for(var s=0;e>s;s++)for(var l=4*(n*e+s),h=0;3>h;h++)r[l+h]=255-r[l+h]}}function KaleidoscopeFilter(){this.name="Kaleidoscope",this.isDirAnimatable=!1,this.defaultValues={angle:0,rotation:0,sides:3,centerX:.5,centerY:.5},this.valueRanges={angle:{min:0,max:360},rotation:{min:0,max:360},sides:{min:1,max:30},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.angle?this.defaultValues.angle:e.angle,l=void 0===e.rotation?this.defaultValues.rotation:e.rotation,h=void 0===e.sides?this.defaultValues.sides:e.sides,o=void 0===e.centerX?this.defaultValues.centerX:e.centerX,u=void 0===e.centerY?this.defaultValues.centerY:e.centerY,d=i*o,v=r*u;s=s/180*Math.PI,l=l/180*Math.PI;var f=function(a,e,i){var r=a-d,n=e-v,o=Math.sqrt(r*r+n*n),u=Math.atan2(n,r)-s-l;u=t.triangle(u/Math.PI*h*.5),u+=s,i[0]=d+o*Math.cos(u),i[1]=v+o*Math.sin(u)};t.transformFilter(n,f,i,r)}}function LensDistortionFilter(){this.name="Lens Distortion",this.isDirAnimatable=!1,this.defaultValues={refraction:1.5,radius:50,centerX:.5,centerY:.5},this.valueRanges={refraction:{min:1,max:10},radius:{min:1,max:200},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.refraction?this.defaultValues.refraction:e.refraction,l=void 0===e.centerX?this.defaultValues.centerX:e.centerX,h=void 0===e.centerY?this.defaultValues.centerY:e.centerY,o=void 0===e.radius?this.defaultValues.radius:e.radius,u=o*o,d=i*l,v=r*h,f=function(t,a,e){var i=t-d,r=a-v,n=i*i,l=r*r;if(l>=u-u*n/u)e[0]=t,e[1]=a;else{var h=1/s,o=Math.sqrt((1-n/u-l/u)*u),f=o*o,m=Math.acos(i/Math.sqrt(n+f)),c=Math.PI/2-m,g=Math.asin(Math.sin(c)*h);g=Math.PI/2-m-g,e[0]=t-Math.tan(g)*o;var p=Math.acos(r/Math.sqrt(l+f));c=Math.PI/2-p,g=Math.asin(Math.sin(c)*h),g=Math.PI/2-p-g,e[1]=a-Math.tan(g)*o}};t.transformFilter(n,f,i,r)}}function LineSmearFilter(){this.name="Line Smear",this.isDirAnimatable=!1,this.defaultValues={distance:8,density:.5,angle:0,mix:.5},this.valueRanges={distance:{min:1,max:30},density:{min:0,max:1},angle:{min:0,max:360},mix:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data,s=[],l;for(l=0;l<n.length;l++)s[l]=n[l];void 0===e&&(e=this.defaultValues);var h=void 0===e.distance?this.defaultValues.distance:e.distance;1>h&&(h=1),h=parseInt(h,10);var o=void 0===e.density?this.defaultValues.density:e.density,u=void 0===e.angle?this.defaultValues.angle:e.angle,d=void 0===e.mix?this.defaultValues.mix:e.mix;u=u/180*Math.PI;for(var v=Math.sin(u),f=Math.cos(u),m=parseInt(2*o*i*r/2,10),c=0;m>c;c++){var g=(Math.random()*Math.pow(2,32)&2147483647)%i,p=(Math.random()*Math.pow(2,32)&2147483647)%r,x=(Math.random()*Math.pow(2,32)&2147483647)%h+1,V=[n[4*(p*i+g)],n[4*(p*i+g)+1],n[4*(p*i+g)+2],n[4*(p*i+g)+3]],w=parseInt(x*f,10),F=parseInt(x*v,10),M=g-w,b=p-F,I=g+w,A=p+F,y,R,D,S,P,W,U;W=M>I?-1:1,U=b>A?-1:1,w=I-M,F=A-b,w=Math.abs(w),F=Math.abs(F),y=M,R=b;var X,Y;if(i>y&&y>=0&&r>R&&R>=0)for(X=[s[4*(R*i+y)],s[4*(R*i+y)+1],s[4*(R*i+y)+2],s[4*(R*i+y)+3]],Y=t.mixColors(d,X,V),l=0;3>l;l++)s[4*(R*i+y)+l]=Y[l];if(Math.abs(w)>Math.abs(F)){for(D=2*F-w,S=2*F,P=2*(F-w);y!=I;)if(0>=D?D+=S:(D+=P,R+=U),y+=W,i>y&&y>=0&&r>R&&R>=0)for(X=[s[4*(R*i+y)],s[4*(R*i+y)+1],s[4*(R*i+y)+2],s[4*(R*i+y)+3]],Y=t.mixColors(d,X,V),l=0;3>l;l++)s[4*(R*i+y)+l]=Y[l]}else for(D=2*w-F,S=2*w,P=2*(w-F);R!=A;)if(0>=D?D+=S:(D+=P,y+=W),R+=U,i>y&&y>=0&&r>R&&R>=0)for(X=[s[4*(R*i+y)],s[4*(R*i+y)+1],s[4*(R*i+y)+2],s[4*(R*i+y)+3]],Y=t.mixColors(d,X,V),l=0;3>l;l++)s[4*(R*i+y)+l]=Y[l]}for(l=0;l<s.length;l++)n[l]=s[l]}}function MaximumFilter(){this.name="Maximum",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={},this.filter=function(t,a){for(var e=t.width,i=t.height,r=t.data,n=[],s=0;i>s;s++)for(var l=0;e>l;l++){for(var h=4*(s*e+l),o=0,u=0,d=0,v=-1;1>=v;v++){var f=s+v;if(f>=0&&i>f)for(var m=-1;1>=m;m++){var c=l+m;if(c>=0&&e>c){var g=4*(f*e+c);o=Math.max(o,r[g]),u=Math.max(u,r[g+1]),d=Math.max(d,r[g+2])}}}n[h]=o,n[h+1]=u,n[h+2]=d,n[h+3]=r[h+3]}for(var p=0;p<n.length;p++)r[p]=n[p]}}function MedianFilter(){this.name="Median",this.isDirAnimatable=!1,this.defaultValues={},this.valueRanges={},this.filter=function(t,a){for(var e=t.width,i=t.height,r=t.data,n=[],s=0;i>s;s++)for(var l=0;e>l;l++){for(var h=4*(s*e+l),o=[],u=[],d=[],v=-1;1>=v;v++){var f=s+v;if(f>=0&&i>f)for(var m=-1;1>=m;m++){var c=l+m;if(c>=0&&e>c){var g=4*(f*e+c);o.push(r[g]),u.push(r[g+1]),d.push(r[g+2])}}}var p=function(t,a){return t-a};o.sort(p),u.sort(p),d.sort(p),n[h]=o[4],n[h+1]=u[4],n[h+2]=d[4],n[h+3]=r[h+3]}for(var x=0;x<n.length;x++)r[x]=n[x]}}function MinimumFilter(){this.name="Minimum",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={},this.filter=function(t,a){for(var e=t.width,i=t.height,r=t.data,n=[],s=0;i>s;s++)for(var l=0;e>l;l++){for(var h=4*(s*e+l),o=255,u=255,d=255,v=-1;1>=v;v++){var f=s+v;if(f>=0&&i>f)for(var m=-1;1>=m;m++){var c=l+m;if(c>=0&&e>c){var g=4*(f*e+c);o=Math.min(o,r[g]),u=Math.min(u,r[g+1]),d=Math.min(d,r[g+2])}}}n[h]=o,n[h+1]=u,n[h+2]=d,n[h+3]=r[h+3]}for(var p=0;p<n.length;p++)r[p]=n[p]}}function NoiseFilter(){this.name="Noise",this.isDirAnimatable=!0,this.defaultValues={amount:25,density:1,monochrome:!0},this.valueRanges={amount:{min:0,max:100},density:{min:0,max:1},monochrome:{min:!1,max:!0}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);for(var n=void 0===a.amount?this.defaultValues.amount:a.amount,s=void 0===a.density?this.defaultValues.density:a.density,l=void 0===a.monochrome?this.defaultValues.monochrome:a.monochrome,h=0;i>h;h++)for(var o=0;e>o;o++){var u=4*(h*e+o);if(Math.random()<=s){var d;if(l)d=parseInt((2*Math.random()-1)*n,10),r[u]+=d,r[u+1]+=d,r[u+2]+=d;else for(var v=0;3>v;v++)d=parseInt((2*Math.random()-1)*n,10),r[u+v]+=d}}}}function OilFilter(){this.name="Oil Painting",this.isDirAnimatable=!1,this.defaultValues={range:3},this.valueRanges={range:{min:0,max:5}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data,n=[];void 0===a&&(a=this.defaultValues);var s=void 0===a.range?this.defaultValues.range:a.range;s=parseInt(s,10);for(var l=0,h=[],o=[],u=[],d=[],v=[],f=[],m=256,c=0;i>c;c++)for(var g=0;e>g;g++){for(var p=4*(c*e+g),x=0;m>x;x++)h[x]=o[x]=u[x]=d[x]=v[x]=f[x]=0;for(var V=-s;s>=V;V++){var w=c+V,F;if(w>=0&&i>w){F=w*e;for(var M=-s;s>=M;M++){var b=g+M;if(b>=0&&e>b){var I=r[4*(F+b)],A=r[4*(F+b)+1],y=r[4*(F+b)+2],R=I*m/256,D=A*m/256,S=y*m/256;d[R]+=I,v[D]+=A,f[S]+=y,h[R]++,o[D]++,u[S]++}}}}for(var P=0,W=0,U=0,X=1;m>X;X++)h[X]>h[P]&&(P=X),o[X]>o[W]&&(W=X),u[X]>u[U]&&(U=X);P=d[P]/h[P],W=v[W]/o[W],U=f[U]/u[U],n[p]=P,n[p+1]=W,n[p+2]=U,n[p+3]=r[p+3]}for(var Y=0;Y<n.length;Y++)r[Y]=n[Y]}}function OpacityFilter(){this.name="Opacity",this.isDirAnimatable=!0,this.defaultValues={amount:1},this.valueRanges={amount:{min:0,max:1}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);for(var n=void 0===a.amount?this.defaultValues.amount:a.amount,s=0;i>s;s++)for(var l=0;e>l;l++){var h=4*(s*e+l);r[h+3]=255*n}}}function PinchFilter(){this.name="Pinch/Whirl",this.isDirAnimatable=!1,this.defaultValues={amount:.5,radius:100,angle:0,centerX:.5,centerY:.5},this.valueRanges={amount:{min:-1,max:1},radius:{min:1,max:200},angle:{min:0,max:360},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.amount?this.defaultValues.amount:e.amount,l=void 0===e.angle?this.defaultValues.angle:e.angle,h=void 0===e.centerX?this.defaultValues.centerX:e.centerX,o=void 0===e.centerY?this.defaultValues.centerY:e.centerY,u=void 0===e.radius?this.defaultValues.radius:e.radius,d=u*u;l=l/180*Math.PI;var v=i*h,f=r*o,m=function(t,a,e){var i=t-v,r=a-f,n=i*i+r*r;if(n>d||0===n)e[0]=t,e[1]=a;else{var h=Math.sqrt(n/d),o=Math.pow(Math.sin(.5*Math.PI*h),-s);i*=o,r*=o;var u=1-h,m=l*u*u,c=Math.sin(m),g=Math.cos(m);e[0]=v+g*i-c*r,e[1]=f+c*i+g*r}};t.transformFilter(n,m,i,r)}}function PixelationFilter(){this.name="Pixelation",this.isDirAnimatable=!1,this.defaultValues={size:5},this.valueRanges={size:{min:1,max:50}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);var n=void 0===a.size?this.defaultValues.size:a.size;n=parseInt(n,10);for(var s=[],l,h,o,u=0;i>u;u+=n)for(var d=0;e>d;d+=n){var v=4*(u*e+d),f=Math.min(n,e-d),m=Math.min(n,i-u),c=f*m,g=0,p=0,x=0;for(l=u;u+m>l;l++)for(h=d;d+f>h;h++)o=4*(l*e+h),g+=r[o],p+=r[o+1],x+=r[o+2];for(l=u;u+m>l;l++)for(h=d;d+f>h;h++)o=4*(l*e+h),r[o]=g/c,r[o+1]=p/c,r[o+2]=x/c}}}function PosterizeFilter(){this.name="Posterize",this.isDirAnimatable=!1,this.defaultValues={levels:6},this.valueRanges={levels:{min:2,max:30}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.levels?this.defaultValues.levels:parseInt(e.levels,10);if(!(1>=s)){for(var l=[],h=0;256>h;h++)l[h]=parseInt(255*parseInt(h*s/256,10)/(s-1),10);t.tableFilter(n,l,i,r)}}}function RGBAdjustFilter(){this.name="RGBAdjust",this.isDirAnimatable=!0,this.defaultValues={red:1,green:1,blue:1},this.valueRanges={red:{min:0,max:2},green:{min:0,max:2},blue:{min:0,max:2}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);var n=void 0===a.red?this.defaultValues.red:a.red,s=void 0===a.green?this.defaultValues.green:a.green,l=void 0===a.blue?this.defaultValues.blue:a.blue;0>n&&(n=0),0>s&&(s=0),0>l&&(l=0);for(var h=0;i>h;h++)for(var o=0;e>o;o++){var u=4*(h*e+o);r[u]*=n,r[u+1]*=s,r[u+2]*=l}}}function SaturationFilter(){this.name="Saturation",this.isDirAnimatable=!0,this.defaultValues={amount:1},this.valueRanges={amount:{min:0,max:2}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);for(var n=void 0===a.amount?this.defaultValues.amount:a.amount,s=.3,l=.59,h=.11,o=(1-n)*s+n,u=(1-n)*s,d=(1-n)*s,v=(1-n)*l,f=(1-n)*l+n,m=(1-n)*l,c=(1-n)*h,g=(1-n)*h,p=(1-n)*h+n,x=0;i>x;x++)for(var V=0;e>V;V++){var w=4*(x*e+V),F=r[w],M=r[w+1],b=r[w+2];r[w]=o*F+v*M+c*b,r[w+1]=u*F+f*M+g*b,r[w+2]=d*F+m*M+p*b}}}function SawtoothRippleFilter(){this.name="Sawtooth Ripples",this.isDirAnimatable=!1,this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16},this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.xAmplitude?this.defaultValues.xAmplitude:e.xAmplitude,l=void 0===e.yAmplitude?this.defaultValues.yAmplitude:e.yAmplitude,h=void 0===e.xWavelength?this.defaultValues.xWavelength:e.xWavelength,o=void 0===e.yWavelength?this.defaultValues.yWavelength:e.yWavelength,u=function(a,e,i){var r=e/h,n=a/o,u=t.mod(r,1),d=t.mod(n,1);i[0]=a+s*u,i[1]=e+l*d};t.transformFilter(n,u,i,r)}}function SepiaFilter(){this.name="Sepia",this.isDirAnimatable=!0,this.defaultValues={amount:10},this.valueRanges={amount:{min:0,max:30}};var t=new FilterUtils;this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);var n=void 0===a.amount?this.defaultValues.amount:a.amount;n*=2.55;for(var s=0;i>s;s++)for(var l=0;e>l;l++){var h=4*(s*e+l),o=.3*r[h]+.59*r[h+1]+.11*r[h+2],u,d,v;u=d=v=o,u+=40,d+=20,v-=n,r[h]=u,r[h+1]=d,r[h+2]=v}}}function SharpenFilter(){this.name="Sharpen",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data,s=[0,-.2,0,-.2,1.8,-.2,0,-.2,0];t.convolveFilter(n,s,i,r)}}function SineRippleFilter(){this.name="Sine Ripples",this.isDirAnimatable=!1,this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16},this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.xAmplitude?this.defaultValues.xAmplitude:e.xAmplitude,l=void 0===e.yAmplitude?this.defaultValues.yAmplitude:e.yAmplitude,h=void 0===e.xWavelength?this.defaultValues.xWavelength:e.xWavelength,o=void 0===e.yWavelength?this.defaultValues.yWavelength:e.yWavelength,u=function(t,a,e){var i=a/h,r=t/o,n=Math.sin(i),u=Math.sin(r);e[0]=t+s*n,e[1]=a+l*u};t.transformFilter(n,u,i,r)}}function SolarizeFilter(){this.name="Solarize",this.isDirAnimatable=!0,this.defaultValues={},this.valueRanges={};var t=new FilterUtils;this.filter=function(a,e){for(var i=a.width,r=a.height,n=a.data,s=[],l=0;256>l;l++){var h=l/255>.5?2*(l/255-.5):2*(.5-l/255);s[l]=parseInt(255*h,10)}t.tableFilter(n,s,i,r)}}function SparkleFilter(){this.name="Sparkle",this.isDirAnimatable=!1,this.defaultValues={rays:50,size:25,amount:50,randomness:25,centerX:.5,centerY:.5},this.valueRanges={rays:{min:1,max:100},size:{min:1,max:200},amount:{min:0,max:100},randomness:{min:0,max:50},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.rays?this.defaultValues.rays:e.rays;s=parseInt(s,10);for(var l=void 0===e.size?this.defaultValues.size:e.size,h=void 0===e.amount?this.defaultValues.amount:e.amount,o=void 0===e.randomness?this.defaultValues.randomness:e.randomness,u=void 0===e.centerX?this.defaultValues.centerX:e.centerX,d=void 0===e.centerY?this.defaultValues.centerY:e.centerY,v=u*i,f=d*r,m=[],c=0;s>c;c++)m[c]=l+o/100*l*t.gaussianRandom();for(var g=0;r>g;g++)for(var p=0;i>p;p++){var x=4*(g*i+p),V=p-v,w=g-f,F=V*V+w*w,M=Math.atan2(w,V),b=(M+Math.PI)/(2*Math.PI)*s,I=parseInt(b,10),A=b-I;if(0!==l){var y=t.linearInterpolate(A,m[I%s],m[(I+1)%s]),R=y*y/(F+1e-4);R=Math.pow(R,(100-h)/50),A-=.5,A=1-A*A,A*=R}A=t.clampPixel(A,0,1);for(var D=t.mixColors(A,[n[x],n[x+1],n[x+2],n[x+3]],[255,255,255,255]),S=0;3>S;S++)n[x+S]=D[S]}}}function SquareSmearFilter(){this.name="Square Smear",this.isDirAnimatable=!1,this.defaultValues={size:4,density:.5,mix:.5},this.valueRanges={size:{min:1,max:10},density:{min:0,max:1},mix:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data,s=[],l;for(l=0;l<n.length;l++)s[l]=n[l];void 0===e&&(e=this.defaultValues);var h=void 0===e.size?this.defaultValues.size:e.size;1>h&&(h=1),h=parseInt(h,10);for(var o=void 0===e.density?this.defaultValues.density:e.density,u=void 0===e.mix?this.defaultValues.mix:e.mix,d=h+1,v=d*d,f=parseInt(2*o/30*i*r/2,10),m=0;f>m;m++)for(var c=(Math.random()*Math.pow(2,32)&2147483647)%i,g=(Math.random()*Math.pow(2,32)&2147483647)%r,p=[n[4*(g*i+c)],n[4*(g*i+c)+1],n[4*(g*i+c)+2],n[4*(g*i+c)+3]],x=c-d;c+d+1>x;x++)for(var V=g-d;g+d+1>V;V++)if(x>=0&&i>x&&V>=0&&r>V){var w=[s[4*(V*i+x)],s[4*(V*i+x)+1],s[4*(V*i+x)+2],s[4*(V*i+x)+3]],F=t.mixColors(u,w,p);for(l=0;3>l;l++)s[4*(V*i+x)+l]=F[l]}for(l=0;l<s.length;l++)n[l]=s[l]}}function ThresholdFilter(){this.name="Black & White",this.isDirAnimatable=!0,this.defaultValues={threshold:127},this.valueRanges={threshold:{min:0,max:255}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data;void 0===a&&(a=this.defaultValues);for(var n=void 0===a.threshold?this.defaultValues.threshold:a.threshold,s=0;i>s;s++)for(var l=0;e>l;l++){var h=4*(s*e+l),o=(r[h]+r[h+1]+r[h+2])/3,u=0;o>n&&(u=255),r[h]=r[h+1]=r[h+2]=u}}}function TriangleRippleFilter(){this.name="Triangle Ripples",this.isDirAnimatable=!1,this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16},this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.xAmplitude?this.defaultValues.xAmplitude:e.xAmplitude,l=void 0===e.yAmplitude?this.defaultValues.yAmplitude:e.yAmplitude,h=void 0===e.xWavelength?this.defaultValues.xWavelength:e.xWavelength,o=void 0===e.yWavelength?this.defaultValues.yWavelength:e.yWavelength,u=function(a,e,i){var r=e/h,n=a/o,u=t.triangle(r,1),d=t.triangle(n,1);i[0]=a+s*u,i[1]=e+l*d};t.transformFilter(n,u,i,r)}}function TwirlFilter(){this.name="Twirl",this.isDirAnimatable=!1,this.defaultValues={radius:100,angle:180,centerX:.5,centerY:.5},this.valueRanges={radius:{min:1,max:200},angle:{min:0,max:360},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;void 0===e&&(e=this.defaultValues);var s=void 0===e.angle?this.defaultValues.angle:e.angle,l=void 0===e.centerX?this.defaultValues.centerX:e.centerX,h=void 0===e.centerY?this.defaultValues.centerY:e.centerY,o=void 0===e.radius?this.defaultValues.radius:e.radius,u=o*o;s=s/180*Math.PI;var d=i*l,v=r*h,f=function(t,a,e){var i=t-d,r=a-v,n=i*i+r*r;if(n>u)e[0]=t,e[1]=a;else{n=Math.sqrt(n);var l=Math.atan2(r,i)+s*(o-n)/o;e[0]=d+n*Math.cos(l),e[1]=v+n*Math.sin(l)}};t.transformFilter(n,f,i,r)}}function VignetteFilter(){this.name="Vignette",this.isDirAnimatable=!1,this.defaultValues={amount:.3},this.valueRanges={amount:{min:0,max:1}},this.filter=function(t,a){var e=t.width,i=t.height,r=t.data,n=[];void 0===a&&(a=this.defaultValues);var s=void 0===a.amount?this.defaultValues.amount:a.amount,l=document.createElement("canvas");l.width=e,l.height=i;var h=l.getContext("2d"),o,u=Math.sqrt(Math.pow(e/2,2)+Math.pow(i/2,2));h.putImageData(t,0,0),h.globalCompositeOperation="source-over",o=h.createRadialGradient(e/2,i/2,0,e/2,i/2,u),o.addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(.5,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,"+s+")"),h.fillStyle=o,h.fillRect(0,0,e,i),n=h.getImageData(0,0,e,i).data;for(var d=0;d<n.length;d++)r[d]=n[d]}}function WaterRippleFilter(){this.name="Water Ripples",this.isDirAnimatable=!1,this.defaultValues={phase:0,radius:50,wavelength:16,amplitude:10,centerX:.5,centerY:.5},this.valueRanges={phase:{min:0,max:100},radius:{min:1,max:200},wavelength:{min:1,max:100},amplitude:{min:1,max:100},centerX:{min:0,max:1},centerY:{min:0,max:1}};var t=new FilterUtils;this.filter=function(a,e){var i=a.width,r=a.height,n=a.data;
void 0===e&&(e=this.defaultValues);var s=void 0===e.wavelength?this.defaultValues.wavelength:e.wavelength,l=void 0===e.amplitude?this.defaultValues.amplitude:e.amplitude,h=void 0===e.phase?this.defaultValues.phase:e.phase,o=void 0===e.centerX?this.defaultValues.centerX:e.centerX,u=void 0===e.centerY?this.defaultValues.centerY:e.centerY,d=void 0===e.radius?this.defaultValues.radius:e.radius,v=d*d,f=i*o,m=r*u,c=function(t,a,e){var i=t-f,r=a-m,n=i*i+r*r;if(n>v)e[0]=t,e[1]=a;else{var o=Math.sqrt(n),u=l*Math.sin(o/s*Math.PI*2-h);u*=(d-o)/d,0!==o&&(u*=s/o),e[0]=t+i*u,e[1]=a+r*u}};t.transformFilter(n,c,i,r)}}var JSManipulate={blur:new BlurFilter,brightness:new BrightnessFilter,bump:new BumpFilter,circlesmear:new CircleSmearFilter,contrast:new ContrastFilter,crosssmear:new CrossSmearFilter,diffusion:new DiffusionFilter,dither:new DitherFilter,edge:new EdgeFilter,emboss:new EmbossFilter,exposure:new ExposureFilter,gain:new GainFilter,gamma:new GammaFilter,grayscale:new GrayscaleFilter,hue:new HueFilter,invert:new InvertFilter,kaleidoscope:new KaleidoscopeFilter,lensdistortion:new LensDistortionFilter,linesmear:new LineSmearFilter,maximum:new MaximumFilter,median:new MedianFilter,minimum:new MinimumFilter,noise:new NoiseFilter,oil:new OilFilter,opacity:new OpacityFilter,pinch:new PinchFilter,pixelate:new PixelationFilter,posterize:new PosterizeFilter,rgbadjust:new RGBAdjustFilter,saturation:new SaturationFilter,sawtoothripple:new SawtoothRippleFilter,sepia:new SepiaFilter,sharpen:new SharpenFilter,sineripple:new SineRippleFilter,solarize:new SolarizeFilter,sparkle:new SparkleFilter,squaresmear:new SquareSmearFilter,threshold:new ThresholdFilter,triangleripple:new TriangleRippleFilter,twirl:new TwirlFilter,vignette:new VignetteFilter,waterripple:new WaterRippleFilter};